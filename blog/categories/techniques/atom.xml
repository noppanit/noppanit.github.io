<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: Techniques | My Blog]]></title>
  <link href="http://noppanit.github.io/blog/categories/techniques/atom.xml" rel="self"/>
  <link href="http://noppanit.github.io/"/>
  <updated>2015-10-01T23:41:14-04:00</updated>
  <id>http://noppanit.github.io/</id>
  <author>
    <name><![CDATA[Noppanit Charassinvichai]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Installing SSL on Amazon CloudFront]]></title>
    <link href="http://noppanit.github.io/installing-ssl-on-amazon-cloudfront/"/>
    <updated>2015-05-22T00:00:00-04:00</updated>
    <id>http://noppanit.github.io/installing-ssl-on-amazon-cloudfront</id>
    <content type="html"><![CDATA[<p>We have just installed SSL on our Amazon CloudFront. We followed this <a href="https://bryce.fisher-fleig.org/blog/setting-up-ssl-on-aws-cloudfront-and-s3/">blog post</a> from Bryce which I think it&#8217;s really good already. However, I was stuck on the last part where you have to upload the certificate to IAM. The difference is that I had to concatenate the crt files myself and I didn&#8217;t know how to do it. So I spent quite a long time to figure it out. I thought I would write this so it might help save sometime for anybody.</p>

<p>If your SSL providers gave you the chained certificate already, then you don&#8217;t have to do anything else. However, when I downloaded my crt files I found this</p>

<pre><code>my_domain.crt
AddTrustExternalCARoot.crt
TrustedSecureCertificateAuthority5.crt
USERTrustRSAAddTrustCA.rt
</code></pre>

<p>And I&#8217;m shocked. So, I thought I would need to upload all of them three times which I did but only one got through and I thought the others must have been backup or some kind (I know I&#8217;m pretty stupid). So, I used <a href="https://www.digicert.com/help/">SSL Checker</a> to check and the site said my trust is broken. I thought how could it be I did everything right.</p>

<p>It turned out that I didn&#8217;t upload all of the chained certificate. So, I went again and I tried to upload the second file which I got a nice error from Amazon that my certificate is malformed. I&#8217;m stumped again.</p>

<p>After a lot of digging and reading. I have to figured out the order of certificates and concatenate all the certificates in the right order until the root. You can ask your SSL provider if you want a quicker answer but I went the hard way.</p>

<p>You can run this command</p>

<pre><code class="bash">openssl x509 -text -noout -in your_domain.crt
</code></pre>

<p>You should start with your <strong>domain.crt</strong> file which will be something like this</p>

<pre><code>Certificate:
    Data:
        Version: 3 (0x2)
        Serial Number:
            xxxxxx
        Signature Algorithm: xxxxx
        Issuer: C=US, ST=DE, L=Wilmington, O=Corporation Service Company, CN=Trusted Secure Certificate Authority 5
        Validity
            Not Before: 
            Not After : 
        Subject: C=US/postalCode=x, ST=xx, L=xxx, O=xxx, LLC, OU=xxx, OU=xxx, CN=xxx
</code></pre>

<p>You just need to look for Issuer which will tell you what is your next immediate certificate. In this case Trusted Secure Certificate Authority 5 is my first certificate and then you go on and do the next one.</p>

<pre><code class="bash">openssl x509 -text -noout -in TrustedSecureCertificateAuthority5.crt
</code></pre>

<p>You will get something like this</p>

<pre><code>Certificate:
    Data:
        Version: 3 (0x2)
        Serial Number:
            xxxxx
        Signature Algorithm: xxxx
        Issuer: C=US, ST=New Jersey, L=Jersey City, O=The USERTRUST Network, CN=USERTrust RSA Certification Authority
        Validity
            Not Before: Sep 10 00:00:00 2014 GMT
            Not After : Sep  9 23:59:59 2024 GMT
        Subject: C=US, ST=DE, L=Wilmington, O=Corporation Service Company, CN=Trusted Secure Certificate Authority 5
</code></pre>

<p>It means <strong>USERTrust</strong> is the next certificate then repeat the process again until you see this.</p>

<pre><code>Certificate:
    Data:
        Version: 3 (0x2)
        Serial Number: xxxx
        Signature Algorithm: xxxxx
        Issuer: C=SE, O=AddTrust AB, OU=AddTrust External TTP Network, CN=AddTrust External CA Root
        Validity
            Not Before: May 30 10:48:38 2000 GMT
            Not After : May 30 10:48:38 2020 GMT
        Subject: C=SE, O=AddTrust AB, OU=AddTrust External TTP Network, CN=AddTrust External CA Root
</code></pre>

<p>If <strong>Issuer</strong> is the same as <strong>Subject</strong> that means this certificate is the root which is going to be the last. Now, what you can do is to concatenate in the correct order of all the certificates.</p>

<p>You can use this command or you can use your favourite editor to do as well.</p>

<pre><code class="bash">cat first_crt second_crt third_crt &gt; your_pem_file
</code></pre>

<p>Then when you&#8217;re ready to upload the certificate to Amazon you can just do this.</p>

<pre><code class="bash">aws iam upload-server-certificate --server-certificate-name your_domain \
--certificate-body file://your_domain.crt \
--private-key file://your_domain.private \
--certificate-chain file://your_pem_file \
--path /cloudfront/
</code></pre>

<p>The <strong>&#8211;certificate-chain</strong> should be your concatenated certificates.</p>

<p>The format of the <strong>pem</strong> should be something like this.
<code>
-----BEGIN CERTIFICATE-----
Intermediate certificate 2
-----END CERTIFICATE-----
-----BEGIN CERTIFICATE-----
Intermediate certificate 1
-----END CERTIFICATE-----
</code></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[How to : A Hand-made Cigarette]]></title>
    <link href="http://noppanit.github.io/how-to-a-hand-made-cigarette/"/>
    <updated>2007-12-12T00:00:00-05:00</updated>
    <id>http://noppanit.github.io/how-to-a-hand-made-cigarette</id>
    <content type="html"><![CDATA[<p>I have been astonishing by this hand-made cigarette in England. It is made by my friend- Not. It is step by step. It&#8217;s dead simple. Have a good look.</p>

<p><img src="http://i2.photobucket.com/albums/y41/newbie_toy/IMG_9730.jpg" height="300" width="400" /></p>

<p><img src="http://i2.photobucket.com/albums/y41/newbie_toy/IMG_9731.jpg" height="300" width="400" /></p>

<p><img src="http://i2.photobucket.com/albums/y41/newbie_toy/IMG_9732.jpg" height="300" width="400" /></p>

<p><img src="http://i2.photobucket.com/albums/y41/newbie_toy/IMG_9733.jpg" height="300" width="400" /></p>

<p><img src="http://i2.photobucket.com/albums/y41/newbie_toy/IMG_9734.jpg" height="300" width="400" /></p>

<p><img src="http://i2.photobucket.com/albums/y41/newbie_toy/IMG_9735.jpg" height="300" width="400" /></p>

<p><img src="http://i2.photobucket.com/albums/y41/newbie_toy/IMG_9736.jpg" height="300" width="400" /></p>

<p><img src="http://i2.photobucket.com/albums/y41/newbie_toy/IMG_9737.jpg" height="300" width="400" /></p>

<p><img src="http://i2.photobucket.com/albums/y41/newbie_toy/IMG_9738.jpg" height="300" width="400" /></p>

<p><img src="http://i2.photobucket.com/albums/y41/newbie_toy/IMG_9739.jpg" height="300" width="400" /></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[HowTo : CPL Filter]]></title>
    <link href="http://noppanit.github.io/howto-cpl-filter/"/>
    <updated>2007-07-17T00:00:00-04:00</updated>
    <id>http://noppanit.github.io/howto-cpl-filter</id>
    <content type="html"><![CDATA[<p>This topic I will record about how to use CPL filter, because I have bought this filter about 5 months. However, I couldn&#8217;t use it well, until now.</p>

<p>The source of light coming from right hand. Therefore, I turned the ring on the filter directed to the source of light.</p>

<p><a href="http://www.noppanit.com/wp-content/uploads/2007/07/img_9672-before.JPG" title="Before Filtering"><img src="http://www.noppanit.com/wp-content/uploads/2007/07/img_9672-before.thumbnail.JPG" alt="Before Filtering" /></a><br/>
This picture took before I used CPL filter.</p>

<p><a href="http://www.noppanit.com/wp-content/uploads/2007/07/img_9671-after.JPG" title="After Filtering"><img src="http://www.noppanit.com/wp-content/uploads/2007/07/img_9671-after.thumbnail.JPG" alt="After Filtering" /></a><br/>
This picture took after I used CPL filter, you can see how is this filter make and effect to the Notebook</p>
]]></content>
  </entry>
  
</feed>
