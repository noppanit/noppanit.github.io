
<!DOCTYPE HTML>
<html>
<head>
	<meta charset="utf-8">
	<title>Public-key cryptography for dummies - My Blog</title>
	<meta name="author" content="Noppanit Charassinvichai">

	
	<meta name="description" content="For the last few days I have been busy in this amazing 29c3 conference in Hamburg, Germany (Not in NewYork). Basically, it&#8217;s a conference about &hellip;">
	
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

	<link href="/atom.xml" rel="alternate" title="My Blog" type="application/atom+xml">
	<link rel="canonical" href=" https://www.noppanit.com/public-key-cryptography-for-dummies/" />
	<link href="/favicon.png" rel="shortcut icon">
	<link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
	<!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
	<script async="true" src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
	
</head>


<body>
	<header id="header" class="inner"><h1><a href="/">My Blog</a></h1>
<nav id="main-nav"><ul class="main">
	<li><a href="/">Blog</a></li>
	<li><a href="/blog/archives">Archives</a></li>
</ul>
</nav>
<nav id="mobile-nav">
	<div class="alignleft menu">
		<a class="button">Menu</a>
		<div class="container"><ul class="main">
	<li><a href="/">Blog</a></li>
	<li><a href="/blog/archives">Archives</a></li>
</ul>
</div>
	</div>
	<div class="alignright search">
		<a class="button"></a>
		<div class="container">
			<form action="https://www.google.com/search" method="get">
				<input type="text" name="q" results="0">
				<input type="hidden" name="q" value="site:www.noppanit.com">
			</form>
		</div>
	</div>
</nav>
<nav id="sub-nav" class="alignright">
	<div class="social">
		
		
		
		<a class="twitter" href="http://twitter.com/noppanit" title="Twitter">Twitter</a>
		
		
		<a class="github" href="https://github.com/noppanit" title="GitHub">GitHub</a>
		
    
		
		
		
		
		
		<a class="rss" href="/atom.xml" title="RSS">RSS</a>
		
    
	</div>
	<form class="search" action="https://www.google.com/search" method="get">
		<input class="alignright" type="text" name="q" results="0">
		<input type="hidden" name="q" value="site:www.noppanit.com">
	</form>
</nav>

</header>
	
		
	
	<div id="content" class="inner"><article class="post">
	<h2 class="title">Public-key Cryptography for Dummies</h2>
	<div class="entry-content"><p>For the last few days I have been busy in this amazing <a href="http://events.ccc.de/congress/2012/wiki/Main_Page" title="29c3">29c3</a> conference in Hamburg, Germany (Not in NewYork). Basically, it&#8217;s a conference about everything that is about security and data. One thing that struck me was this talk <a href="http://events.ccc.de/congress/2012/Fahrplan/events/5275.en.html" title="RSA factorisation in the real world">RSA factorisation in the real world</a> from <a href="http://facthacks.cr.yp.to/" title="face hacks">facthack</a>. Why it struck me, it&#8217;s because we have been using it a lot but I think I know nothing about it. And every time you Google about it, you get a lot of mathematical examples (Of course the algorithm is about maths). So, I guess I would just want to write it down so I could remember it myself also if it would benefit others that&#8217;d be fantastic.</p>

<p>So, we all like Wikipedia, here&#8217;s the <a href="http://en.wikipedia.org/wiki/Public-key_cryptography" title="public key cryptography">wiki</a> version. But if you&#8217;re lazy like me you might want to watch this video which I think they virtualise it pretty good.</p>

<iframe width="420" height="315" src="https://www.youtube.com/embed/wXB-V_Keiu8" frameborder="0" allowfullscreen></iframe>


<p>And here is my version of it. I think the concept is basic and really easy to understand, though it took me a couple days to understand it. Imagine you want to send a note to a girl you like across the room where you have a lot of friends who try to bully or mock you. I ask the girl to buy a box with a lock and a key so nobody with that key can open the box. Then, she will send me the box across the room, it may pass a lot of people but they cannot open the box without her key. I will put the message in the box and close it and send it back. Then she could open that box with her key. I know this is not exactly right, but the point is that she has a key which is private-key and the box is public-key. As the names suggest, public means it&#8217;s wide open you can send it to anywhere publicly, but the key is private and you keep it.</p>

<p>Another example that I can think of is SSH. I&#8217;m gonna skip what SSH is but when you want to connect to the server you need to enter a password and then the connection is open. So, one example that I can think of is Github. When you create an account on Github, it asks you to upload your public key. You have to do <a href="https://help.github.com/articles/generating-ssh-keys" title="Github upload ssh keys">these steps</a></p>

<p>First, you use this command to generate public/private keys</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>ssh-keygen -t rsa -C <span class="s2">&quot;your_email@youremail.com&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Basically, that would generate public/private keys in your home folder. if you saved the keys in your home folder that you can view your keys.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>ls ~/.ssh/
</span><span class='line'>id_rsa    id_rsa.pub  known_hosts
</span></code></pre></td></tr></table></div></figure>


<p>file <strong>id_rsa.pub</strong> is your public key and <strong>id_rsa</strong> is your private key. Then you upload <strong>id_rsa.pub</strong> to Github and then you can connect to Github via SSH without having to use password every time. I think EC2 and Heroku are the same.</p>

<p>Now, we all love coding what about in code? I have some example here which is in Python and I think all the languages are the same.</p>

<p>I use the library <strong>rsa</strong>. You can install it easily</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>pip install rsa
</span></code></pre></td></tr></table></div></figure>


<p>Then you can generate the keys.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="kn">import</span> <span class="nn">rsa</span>
</span><span class='line'><span class="p">(</span><span class="n">public_key</span><span class="p">,</span> <span class="n">private_key</span><span class="p">)</span> <span class="o">=</span> <span class="n">rsa</span><span class="o">.</span><span class="n">new_keys</span><span class="p">(</span><span class="mi">2048</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>it might take a couple seconds to get the keys, but 2048 should be your standard by now. Now have a look at the keys</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="o">&gt;&gt;&gt;</span> <span class="n">public_key</span>
</span><span class='line'><span class="n">PublicKey</span><span class="p">(</span><span class="mi">29534209309072966342236728315019059662080809378008690867170941707045309003902270154173510852052110681489591796447806519430369798984624459707158855145174351259726003060555580062598516787344976412595591636803388841296208018460473115348727377101381087280966955180437218649614860816115625029885144484815954440118725591030107342156415013995103531215123098501644397412095363703762543423709714830195367078829211889094350240474706872694251558468928015513092692877035574929167783047652545773000357002867146591894383127690358099462086703188180088169904549856171296368406173474768408900722887810563868713819753518447862895139133</span><span class="p">,</span> <span class="mi">65537</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="o">&gt;&gt;&gt;</span> <span class="n">private_key</span>
</span><span class='line'><span class="n">PrivateKey</span><span class="p">(</span><span class="mi">29534209309072966342236728315019059662080809378008690867170941707045309003902270154173510852052110681489591796447806519430369798984624459707158855145174351259726003060555580062598516787344976412595591636803388841296208018460473115348727377101381087280966955180437218649614860816115625029885144484815954440118725591030107342156415013995103531215123098501644397412095363703762543423709714830195367078829211889094350240474706872694251558468928015513092692877035574929167783047652545773000357002867146591894383127690358099462086703188180088169904549856171296368406173474768408900722887810563868713819753518447862895139133</span><span class="p">,</span> <span class="mi">65537</span><span class="p">,</span> <span class="mi">5853484973611070995305138533710462272468493110929015451938345695299014581865001251698425812248117332832877730809474936003800499244873691306228334673248236088203321082038488631354687192743395312925586153935017130164585592135482022296788377575565542253879179407642996063900505472336632032487580151280432952533330871039500260846987279615245989379283555335473200579408998561597984286865492093479293281454202362991371489340478090036107586685417432250640745863007335226075029799578308740141059780564838880874147399808234159082348507409570253455570613403424844782542465277813808638221548094905955710788792599684368754627553</span><span class="p">,</span> <span class="mi">3048836616267442645717253566428183242785699256710435915408206917831986485110304443207329137538405008020749764914855054897471943691960276026164383471359068144785145380429590398022467222960109449831417790058882587360642554647616357991607084035635835566066548855867645483820873548134124697487374239771390745052467948610194583244121</span><span class="p">,</span> <span class="mi">9687042313612202470579779908557945791161444599629082668056659471372738761222623451977742705688117439787620866981353449588434275887551340654960295016278042883725967841149851338806541074750203724704414741041773527871314525574722367110086522054749464369889004170596421460710729163676852042373</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>You can see some prime numbers. Then, I will send the <strong>public_key</strong> to my friend, or Github. Now my friend with encrypt the message and send it back to me.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="n">crypto</span> <span class="o">=</span> <span class="n">rsa</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span><span class="s">&quot;Encrypted_Message&quot;</span><span class="p">,</span> <span class="n">public_key</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>You will get an encrypted message, we can take a peek let&#8217;s see what&#8217;s inside</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="o">&gt;&gt;&gt;</span> <span class="n">crypto</span>
</span><span class='line'><span class="s">&quot;</span><span class="se">\x95</span><span class="s">G</span><span class="se">\x0e</span><span class="s">Z</span><span class="se">\xad\xfb</span><span class="s">-</span><span class="se">\xe1\xd3\x8a\xa5\x0e</span><span class="s">;</span><span class="se">\xf2\xa4</span><span class="s">%</span><span class="se">\xc4</span><span class="s">@</span><span class="se">\x9f\xc8\xd9\xf8\xab\x9c</span><span class="s">I8</span><span class="se">\x83</span><span class="s">A/0</span><span class="se">\x9e\\\xc4</span><span class="s">_?</span><span class="se">\xa5\x12</span><span class="s">y</span><span class="se">\x12\xcf</span><span class="s">z E</span><span class="se">\xd4</span><span class="s">{d</span><span class="se">\xe6</span><span class="s">Hk</span><span class="se">\xaa\x88\xbe\x08\xd3</span><span class="s">S</span><span class="se">\x05</span><span class="s">c</span><span class="se">\xf5\x99</span><span class="s">&amp;</span><span class="se">\x19\x0b</span><span class="s">xHx/|</span><span class="se">\xb9\x85\x98\xa6\x8f\x7f\x13\x98</span><span class="s">/</span><span class="se">\xae</span><span class="s">d</span><span class="se">\x1a\xaa</span><span class="s">eOS(</span><span class="se">\xf2\xfc</span><span class="s">G</span><span class="se">\x19</span><span class="s">MH</span><span class="se">\xdd\xed\xdb\xe9\xdf\xd8</span><span class="s">k</span><span class="se">\x16</span><span class="s">xy</span><span class="se">\xb1\x12\x17\xfd</span><span class="s">uG</span><span class="se">\xd5</span><span class="s">7G</span><span class="se">\x02\xfe\x9e\x87\x02</span><span class="s">Z?</span><span class="se">\xf5\xc0</span><span class="s">9,3</span><span class="se">\xd4</span><span class="s">b</span><span class="se">\x06\x11\xf1\xe2</span><span class="s">H</span><span class="se">\x7f\xa3</span><span class="s">?</span><span class="se">\xa8\x88\xef\x95\xc7\xb2\x7f\xa1</span><span class="s">y7u</span><span class="se">\xdf\x10</span><span class="s">%</span><span class="se">\xfb</span><span class="s">e*</span><span class="se">\xfd</span><span class="s">)</span><span class="se">\xae\xcb</span><span class="s">=</span><span class="se">\n\xdd</span><span class="s">X:</span><span class="se">\xcd</span><span class="s">&amp;</span><span class="se">\xca\x85</span><span class="s">i:lJ</span><span class="se">\xc8</span><span class="s">tGg</span><span class="se">\x9b\xd9\x1c</span><span class="s">;`</span><span class="se">\xe4\x87</span><span class="s">3</span><span class="se">\x82\x1d\x11\xc3</span><span class="s">P</span><span class="se">\xf8</span><span class="s">z</span><span class="se">\xa4</span><span class="s">eU</span><span class="se">\xa3</span><span class="s">V</span><span class="se">\\</span><span class="s">4</span><span class="se">\x8a</span><span class="s">i</span><span class="se">\xa7\x9a\xcf</span><span class="s">Y</span><span class="se">\xfd\xed\x1b\xae\xb7\xe1</span><span class="s">7</span><span class="se">\x16</span><span class="s">3~</span><span class="se">\x1a\xbb\x0e\xd8</span><span class="s">w3#</span><span class="se">\x83\xea</span><span class="s">4</span><span class="se">\xb6</span><span class="s">8</span><span class="se">\xa1\x9b\x88</span><span class="s">T&#39;</span><span class="se">\x9c\xa9\x9a\xbc\x1f</span><span class="s">0FP[}</span><span class="se">\r\x90</span><span class="s">8</span><span class="se">\x8b\x95\xa2\xf5\xb8\x16</span><span class="s">Xi</span><span class="se">\xd5\xd0</span><span class="s">&gt;o</span><span class="se">\xe5\x93\xab</span><span class="s">g</span><span class="se">\xa4\xe7</span><span class="s">L&quot;</span>
</span></code></pre></td></tr></table></div></figure>


<p>You can see it&#8217;s gibberish. Then my friend can send this <strong>crpyto</strong> back to me. And I&#8217;ll try to decrypt it.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="n">rsa</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">crypto</span><span class="p">,</span><span class="n">private_key</span><span class="p">)</span>
</span><span class='line'><span class="s">&#39;Encrypted_Message&#39;</span>
</span></code></pre></td></tr></table></div></figure>


<p>Now let&#8217;s try to decrypt the message with some other private key. You&#8217;ll get this.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="o">&gt;&gt;&gt;</span> <span class="p">(</span><span class="n">newpublic_key</span><span class="p">,</span><span class="n">newprivate_key</span><span class="p">)</span> <span class="o">=</span> <span class="n">rsa</span><span class="o">.</span><span class="n">newkeys</span><span class="p">(</span><span class="mi">2048</span><span class="p">)</span>
</span><span class='line'><span class="o">&gt;&gt;&gt;</span> <span class="n">rsa</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">crypto</span><span class="p">,</span> <span class="n">newprivate_key</span><span class="p">)</span>
</span><span class='line'><span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">):</span>
</span><span class='line'>  <span class="n">File</span> <span class="s">&quot;&lt;stdin&gt;&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">1</span><span class="p">,</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
</span><span class='line'>  <span class="n">File</span> <span class="s">&quot;/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/rsa/pkcs1.py&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">232</span><span class="p">,</span> <span class="ow">in</span> <span class="n">decrypt</span>
</span><span class='line'>    <span class="k">raise</span> <span class="n">DecryptionError</span><span class="p">(</span><span class="s">&#39;Decryption failed&#39;</span><span class="p">)</span>
</span><span class='line'><span class="n">rsa</span><span class="o">.</span><span class="n">pkcs1</span><span class="o">.</span><span class="n">DecryptionError</span><span class="p">:</span> <span class="n">Decryption</span> <span class="n">failed</span>
</span></code></pre></td></tr></table></div></figure>


<p>If you&#8217;re interested some really hardcore stuff how to hack it. I recommend he talk from 29c3 conference.</p>

<iframe width="560" height="315" src="https://www.youtube.com/embed/N5Wn6ZBLjgU" frameborder="0" allowfullscreen></iframe>



</div>


<div class="meta">
	<div class="date">




Dec 29th, 2012</div>
	<div class="tags">


	<a class='category' href='/blog/categories/knowledges/'>knowledges</a>


</div>
	
</div>
</article>

	<div class="share">
	<div class="addthis_toolbox addthis_default_style ">
		
		
		<a class="addthis_button_tweet"></a>
		
		
		
	</div>
	
</div>



<section id="comment">
    <h2 class="title">Comments</h2>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
</section>
</div>
	<footer id="footer" class="inner">Copyright &copy; 2015

    Noppanit Charassinvichai

</footer>
	<script src="/javascripts/slash.js"></script>
<script src="/javascripts/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
	$('.fancybox').fancybox();
})(jQuery);
</script> <!-- Delete or comment this line to disable Fancybox -->


<script type="text/javascript">
      var disqus_shortname = 'noppanit';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'https://www.noppanit.com/public-key-cryptography-for-dummies/';
        var disqus_url = 'https://www.noppanit.com/public-key-cryptography-for-dummies/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//go.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



	<script type="text/javascript">
		var _gaq = _gaq || [];
		_gaq.push(['_setAccount', 'UA-11403715-1']);
		_gaq.push(['_trackPageview']);

		(function() {
			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		})();
	</script>



</body>
</html>